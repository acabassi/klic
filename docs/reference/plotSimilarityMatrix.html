<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot similarity matrix with pheatmap — plotSimilarityMatrix • klic</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot similarity matrix with pheatmap — plotSimilarityMatrix" />
<meta property="og:description" content="Plot similarity matrix with pheatmap" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-128138627-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-128138627-4');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">klic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">
    <span class="fa fa-play-circle"></span>
     
    Vignettes
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-pencil"></span>
     
    Documentation
  </a>
</li>
<li>
  <a href="https://github.com/acabassi/klic">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/acabassi/klic/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot similarity matrix with pheatmap</h1>
    <small class="dont-index">Source: <a href='http://github.com/acabassi/klic/blob/master/R/plot-similarity-matrix.R'><code>R/plot-similarity-matrix.R</code></a></small>
    <div class="hidden name"><code>plotSimilarityMatrix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plot similarity matrix with pheatmap</p>
    </div>

    <pre class="usage"><span class='fu'>plotSimilarityMatrix</span>(
  <span class='no'>X</span>,
  <span class='kw'>y</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>clusLabels</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>colX</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>colY</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>myLegend</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>fileName</span> <span class='kw'>=</span> <span class='st'>"posteriorSimilarityMatrix"</span>,
  <span class='kw'>savePNG</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>semiSupervised</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>showObsNames</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>clr</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>clc</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>plotWidth</span> <span class='kw'>=</span> <span class='fl'>500</span>,
  <span class='kw'>plotHeight</span> <span class='kw'>=</span> <span class='fl'>450</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>Similarity matrix.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Vector</p></td>
    </tr>
    <tr>
      <th>clusLabels</th>
      <td><p>Cluster labels</p></td>
    </tr>
    <tr>
      <th>colX</th>
      <td><p>Colours for the matrix</p></td>
    </tr>
    <tr>
      <th>colY</th>
      <td><p>Colours for the response</p></td>
    </tr>
    <tr>
      <th>myLegend</th>
      <td><p>Vector of strings with the names of the variables</p></td>
    </tr>
    <tr>
      <th>fileName</th>
      <td><p>If <code>savePNG</code> is TRUE, this is the string containing the
name of the output file. Can be used to specify the folder path too. Default
is "posteriorSimilarityMatrix". The extension ".png" is automatically added
to this string.</p></td>
    </tr>
    <tr>
      <th>savePNG</th>
      <td><p>Boolean: if TRUE, the plot is saved as a png file. Default is
FALSE.</p></td>
    </tr>
    <tr>
      <th>semiSupervised</th>
      <td><p>Boolean flag: if TRUE, the response is plotted next to
the matrix.</p></td>
    </tr>
    <tr>
      <th>showObsNames</th>
      <td><p>Boolean. If TRUE, observation names are shown in the
plot. Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>clr</th>
      <td><p>Boolean. If TRUE, rows are ordered by hierarchical clustering.
Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>clc</th>
      <td><p>Boolean. If TRUE, columns are ordered by hierarchical clustering.
Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>plotWidth</th>
      <td><p>Plot width. Default is 500.</p></td>
    </tr>
    <tr>
      <th>plotHeight</th>
      <td><p>Plot height. Default is 450.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>No return value. This function plots the similarity matrix either
to screen or to a png file.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Load one dataset with 100 observations, 2 variables, 4 clusters</span>
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"dataset1.csv"</span>,
<span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"klic"</span>), <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='fl'>1</span>))
<span class='co'># Load cluster labels</span>
<span class='no'>cluster_labels</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>,
<span class='st'>"cluster_labels.csv"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"klic"</span>), <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='fl'>1</span>))

<span class='co'># Compute consensus clustering with K=4 clusters</span>
<span class='no'>cm</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>coca</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/coca/man/consensusCluster.html'>consensusCluster</a></span>(<span class='no'>data</span>, <span class='fl'>4</span>)

<span class='co'># Plot consensus (similarity) matrix</span>
<span class='fu'>plotSimilarityMatrix</span>(<span class='no'>cm</span>)</div><div class='img'><img src='plotSimilarityMatrix-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Plot consensus (similarity) matrix with response</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>cluster_labels</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='fl'>1</span>:<span class='fl'>100</span>)
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>cm</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>cluster_labels</span>)
<span class='fu'>plotSimilarityMatrix</span>(<span class='no'>cm</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>cluster_labels</span>)</div><div class='img'><img src='plotSimilarityMatrix-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://alessandracabassi.wordpress.com'>Alessandra Cabassi</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


