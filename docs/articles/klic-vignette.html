<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to klic • klic</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to klic">
<meta property="og:description" content="klic">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-128138627-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-128138627-4');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">klic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">
    <span class="fa fa-play-circle"></span>
     
    Vignettes
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-pencil"></span>
     
    Documentation
  </a>
</li>
<li>
  <a href="https://github.com/acabassi/klic">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/acabassi/klic/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to klic</h1>
                        <h4 class="author">Alessandra Cabassi</h4>
            
            <h4 class="date">2020-07-08</h4>
      
      <small class="dont-index">Source: <a href="http://github.com/acabassi/klic/blob/master/vignettes/klic-vignette.Rmd"><code>vignettes/klic-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>klic-vignette.Rmd</code></div>

    </div>

    
    
<p>The R package <strong>klic</strong> (<strong>K</strong>ernel <strong>L</strong>earning <strong>I</strong>ntegrative <strong>C</strong>lustering) contains a collection of tools for integrative clustering of multiple data types.</p>
<p>The main function in this package is <code>klic</code>. It takes as input a list of datasets and builds one kernel per dataset, using consensus clustering. The kernels are then combined through localised kernel k-means to obtain the final clustering. The function also gives the user the option to try several different values for the number of clusters both at the level of the individual datasets and for the final clustering. This is the simplest way to perform Kernel Learning Integrative Clustering. However, users may want to include other types of kernels (instead of using only those derived from consensus clustering) or try different parameters for consensus clustering and include all the corresponding kernels in the analysis. Therefore, we also make available some of the functions needed to build a customised KLIC pipeline, that are:</p>
<ul>
<li><p><code>spectrumShift</code>. This function takes as input any symmetric matrix (including co-clustering matrices) and checks whether it is positive semi-definite. If not, the eigenvalues of matrix are shifted by a (small) constant in order to make sure that it is a valid kernel.</p></li>
<li><p><code>lmkkmeans</code>. This is a function implemented by Gonen and Margolin (2014) that performs localised kernel k-means on a set of kernel matrices (such as -appropriately shifted- co-clustering matrices, for example).</p></li>
</ul>
<p>The other function needed for this is <code>consensusCluster</code>. This function can be found in the R package <code>coca</code> and is used to perform consensus clustering on one dataset and obtain a co-clustering matrix (Monti et al. 2003).</p>
<p>Other functions included in the package are:</p>
<ul>
<li>
<code>kkmeans</code>, another function implemented by Gonen and Margolin (2004) to perform kernel k-means with only one kernel matrix (Girolami, 2002);</li>
<li>
<code>copheneticCorrelation</code>, to calculate the cophenetic correlation of a similarity matrix.</li>
</ul>
<div id="how-klic-works" class="section level1">
<h1 class="hasAnchor">
<a href="#how-klic-works" class="anchor"></a>How KLIC works</h1>
<p>First, we generate four datasets with the same clustering structure (6 clusters of equal size) and different levels of noise.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co">## Load synthetic data</span>
<span class="no">data1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"dataset1.csv"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"klic"</span>), <span class="kw">row.names</span> <span class="kw">=</span> <span class="fl">1</span>))
<span class="no">data2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"dataset2.csv"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"klic"</span>), <span class="kw">row.names</span> <span class="kw">=</span> <span class="fl">1</span>))
<span class="no">data3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"dataset3.csv"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"klic"</span>), <span class="kw">row.names</span> <span class="kw">=</span> <span class="fl">1</span>))
<span class="no">data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="no">data1</span>, <span class="no">data2</span>, <span class="no">data3</span>)
<span class="no">n_datasets</span> <span class="kw">&lt;-</span> <span class="fl">3</span>
<span class="no">N</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">data</span><span class="kw">[[</span><span class="fl">1</span>]])[<span class="fl">1</span>]
<span class="no">true_labels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"cluster_labels.csv"</span>,
                                                 <span class="kw">package</span> <span class="kw">=</span> <span class="st">"klic"</span>), <span class="kw">row.names</span> <span class="kw">=</span> <span class="fl">1</span>))</pre></body></html></div>
<p>Now we can use the <code>consensusClustering</code> function to compute a consensus matrix for each dataset.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co">## Compute co-clustering matrices for each dataset</span>
<span class="no">CM</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fl">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">N</span>, <span class="no">N</span>, <span class="no">n_datasets</span>))
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>: <span class="no">n_datasets</span>){
  <span class="co"># Scale the columns to have zero mean and unitary variance</span>
  <span class="no">scaledData</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span>(<span class="no">data</span><span class="kw">[[</span><span class="no">i</span>]])
  <span class="co"># Use consensus clustering to find the consensus matrix of each dataset</span>
  <span class="no">CM</span>[,,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="kw pkg">coca</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/coca/man/consensusCluster.html">consensusCluster</a></span>(<span class="no">scaledData</span>, <span class="kw">K</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">B</span> <span class="kw">=</span> <span class="fl">50</span>)
}
<span class="co">## Plot consensus matrix of one of the datasets</span>
<span class="no">true_labels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">true_labels</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">true_labels</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="fl">1</span>:<span class="no">N</span>)
<span class="no">CM3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">CM</span>[,,<span class="fl">3</span>])
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">CM3</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">CM3</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">true_labels</span>)
<span class="kw pkg">klic</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plotSimilarityMatrix.html">plotSimilarityMatrix</a></span>(<span class="no">CM3</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="no">true_labels</span>))</pre></body></html></div>
<p><img src="klic-vignette_files/figure-html/consensus_cluster-1.png" width="700"></p>
<p>Before using kernel methods, we need to make sure that all the consensus matrices are positive semi-definite.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co">## Check if consensus matrices are PSD and shift eigenvalues if needed.</span>
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>: <span class="no">n_datasets</span>){
  <span class="no">CM</span>[,,<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="kw pkg">klic</span><span class="kw ns">::</span><span class="fu"><a href="../reference/spectrumShift.html">spectrumShift</a></span>(<span class="no">CM</span>[,,<span class="no">i</span>], <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
}
<span class="co">## Plot updated consensus matrix of one of the datasets</span>
<span class="no">true_labels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">true_labels</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">true_labels</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="fl">1</span>:<span class="no">N</span>)
<span class="no">CM3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">CM</span>[,,<span class="fl">3</span>])
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">CM3</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">CM3</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">true_labels</span>)
<span class="kw pkg">klic</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plotSimilarityMatrix.html">plotSimilarityMatrix</a></span>(<span class="no">CM3</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="no">true_labels</span>))</pre></body></html></div>
<p><img src="klic-vignette_files/figure-html/spectrum_shift-1.png" width="700"></p>
<p>Now we can perform localised kernel k-kmeans on the set of consensus matrices using the function <code>lmkkmeans</code> to find a global clustering. This functions also need to be provided with a list of parameters containing the prespecified number of clusters and the maximum number of iterations for the k-means algorithm.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co">## Perform localised kernel k-means on the consensus matricess</span>
<span class="no">parameters</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="no">parameters</span>$<span class="no">cluster_count</span> <span class="kw">&lt;-</span> <span class="fl">4</span> <span class="co"># set the number of clusters K</span>
<span class="no">parameters</span>$<span class="no">iteration_count</span> <span class="kw">&lt;-</span> <span class="fl">100</span> <span class="co"># set the maximum number of iterations</span>
<span class="no">lmkkm</span> <span class="kw">&lt;-</span> <span class="kw pkg">klic</span><span class="kw ns">::</span><span class="fu"><a href="../reference/lmkkmeans.html">lmkkmeans</a></span>(<span class="no">CM</span>, <span class="no">parameters</span>)</pre></body></html></div>
<p>The output of <code>lmkkmeans</code> contains, among other things, the final cluster labels. To compare two clusterings, such as for example the true clustering (that is known in this case) and the clustering found with KLIC, we suggest to use the <code>adjustedRandIndex</code> function of the R package <code>mclust</code>. An ARI close to 1 indicates a high similarity between the two partitions of the data.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co">## Compare clustering found with KLIC to the true one</span>
<span class="kw pkg">mclust</span><span class="kw ns">::</span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/adjustedRandIndex.html">adjustedRandIndex</a></span>(<span class="no">true_labels</span>, <span class="no">lmkkm</span>$<span class="no">clustering</span>)</pre></body></html></div>
<pre><code>## [1] 1</code></pre>
<p>If the global number of clusters is not known, one can find the weights and clusters for different values of K and then find the one that maximises the silhouette.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co">## Find the value of k that maximises the silhouette</span>

<span class="co"># Initialise array of kernel matrices </span>
<span class="no">maxK</span> <span class="kw">=</span> <span class="fl">6</span>
<span class="no">KM</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">N</span>, <span class="no">N</span>, <span class="no">maxK</span>-<span class="fl">1</span>))
<span class="no">clLabels</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="fl">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">maxK</span>-<span class="fl">1</span>, <span class="no">N</span>))

<span class="no">parameters</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="no">parameters</span>$<span class="no">iteration_count</span> <span class="kw">&lt;-</span> <span class="fl">100</span> <span class="co"># set the maximum number of iterations</span>

<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">2</span>:<span class="no">maxK</span>){

  <span class="co"># Use kernel k-means with K=i to find weights and cluster labels</span>
  <span class="no">parameters</span>$<span class="no">cluster_count</span> <span class="kw">&lt;-</span> <span class="no">i</span> <span class="co"># set the number of clusters K</span>
  <span class="no">lmkkm</span> <span class="kw">&lt;-</span> <span class="kw pkg">klic</span><span class="kw ns">::</span><span class="fu"><a href="../reference/lmkkmeans.html">lmkkmeans</a></span>(<span class="no">CM</span>, <span class="no">parameters</span>)

  <span class="co"># Compute weighted matrix</span>
  <span class="kw">for</span>(<span class="no">j</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">CM</span>)[<span class="fl">3</span>]){
    <span class="no">KM</span>[,,<span class="no">i</span>-<span class="fl">1</span>] <span class="kw">&lt;-</span> <span class="no">KM</span>[,,<span class="no">i</span>-<span class="fl">1</span>] + (<span class="no">lmkkm</span>$<span class="no">Theta</span>[,<span class="no">j</span>]<span class="kw">%*%</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">lmkkm</span>$<span class="no">Theta</span>[,<span class="no">j</span>]))*<span class="no">CM</span>[,,<span class="no">j</span>]
  }

  <span class="co"># Save cluster labels</span>
  <span class="no">clLabels</span>[<span class="no">i</span>-<span class="fl">1</span>,] <span class="kw">&lt;-</span> <span class="no">lmkkm</span>$<span class="no">clustering</span>
}

<span class="co"># Find value of K that maximises silhouette</span>
<span class="no">maxSil</span> <span class="kw">&lt;-</span> <span class="kw pkg">coca</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/coca/man/maximiseSilhouette.html">maximiseSilhouette</a></span>(<span class="no">KM</span>, <span class="no">clLabels</span>, <span class="kw">maxK</span> <span class="kw">=</span> <span class="fl">4</span>)
<span class="no">maxSil</span>$<span class="no">k</span></pre></body></html></div>
<pre><code>## NULL</code></pre>
<p>The same can be done simply using the function <code>klic</code></p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">klic</span> <span class="kw">&lt;-</span> <span class="kw pkg">klic</span><span class="kw ns">::</span><span class="fu"><a href="../reference/klic.html">klic</a></span>(<span class="no">data</span>, <span class="kw">M</span> <span class="kw">=</span> <span class="no">n_datasets</span>, <span class="kw">individualK</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>))</pre></body></html></div>
<pre><code>## [1] "All datasets contain the same number of observations 100."
## [1] "We assume that the observations are the same in each dataset\n                and that they are in the same order."
## [1] "*** Generating similarity matrices ***"
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |======================================================================| 100%
## [1] "*** Choosing the number of clusters for the global clustering ***"
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |======================================================================| 100%
## [1] "Global K = 4"</code></pre>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">klic</span>$<span class="no">globalK</span></pre></body></html></div>
<pre><code>## [1] 4</code></pre>
</div>
<div id="other-useful-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#other-useful-functions" class="anchor"></a>Other useful functions</h1>
<p><code>kkmeans</code> is the analogous of <code>lmkkmeans</code>, for just one dataset at a time.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="co">## Set parameters of the kernel k-means algorithm</span>
<span class="no">parameters</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="no">parameters</span>$<span class="no">cluster_count</span> <span class="kw">&lt;-</span> <span class="fl">4</span>
<span class="no">parameters</span>$<span class="no">iteration_count</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="co">## Run kernel k-means</span>
<span class="no">kkm</span> <span class="kw">&lt;-</span> <span class="kw pkg">klic</span><span class="kw ns">::</span><span class="fu"><a href="../reference/kkmeans.html">kkmeans</a></span>(<span class="no">CM</span>[,,<span class="fl">3</span>], <span class="no">parameters</span>)
<span class="co">## Compare clustering to the true labels</span>
<span class="no">clusterLabels</span> <span class="kw">&lt;-</span> <span class="no">kkm</span>$<span class="no">clustering</span>
<span class="kw pkg">mclust</span><span class="kw ns">::</span><span class="fu"><a href="https://mclust-org.github.io/mclust/reference/adjustedRandIndex.html">adjustedRandIndex</a></span>(<span class="no">true_labels</span>, <span class="no">lmkkm</span>$<span class="no">clustering</span>)</pre></body></html></div>
<pre><code>## [1] 0.9103916</code></pre>
<p>We also included <code>copheneticCorrelation</code>, a function that calculates the cophenetic correlation coefficient of a similarity matrix:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="co">## Compute cophenetic correlation coefficient for each consensus matrix</span>
<span class="no">ccc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>, <span class="no">n_datasets</span>)
<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">n_datasets</span>){
  <span class="no">ccc</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="kw pkg">klic</span><span class="kw ns">::</span><span class="fu"><a href="../reference/copheneticCorrelation.html">copheneticCorrelation</a></span>(<span class="no">CM</span>[,,<span class="no">i</span>])
}
<span class="no">ccc</span></pre></body></html></div>
<pre><code>## [1] 0.9963582 0.9943875 0.9971555</code></pre>
<p>The cophenetic correlation coefficient is a measure of how faithfully hierarchical clustering would preserve the pairwise distances between the original data points.</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Cabassi, A. and Kirk, P. D. W. (2020). Multiple kernel learning for integrative consensus clustering of ’omic datasets. Bioinformatics, btaa593.</p>
<p>Girolami, M. (2002). Mercer kernel-based clustering in feature space. IEEE Transactions on Neural Networks, 13(3), pp.780-784.</p>
<p>Gonen, M. and Margolin, A. A. (2014). Localized Data Fusion for Kernel k-Means Clustering with Application to Cancer Biology. NIPS, (i), 1–9.</p>
<p>Monti, S. et al. (2003). Consensus Clustering: A Resampling-Based Method for Class Discovery and Visualization of Gene. Machine Learning, 52(i), 91–118.</p>
<p>The Cancer Genome Atlas (2012). Comprehensive molecular portraits of human breast tumours. Nature, 487(7407), 61–70.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://alessandracabassi.wordpress.com">Alessandra Cabassi</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
